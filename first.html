

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>First Day &mdash; Sphinx Page GitHub Action  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Second Day" href="second.html" />
    <link rel="prev" title="About the course" href="about.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Sphinx Page GitHub Action
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About the course</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">First Day</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-docker-and-singularity-containers">Introduction to Docker and Singularity containers.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-hub-biocontainers-and-other-repositories-find-existing-containers-execute-a-singularity-container">Docker hub, BioContainers and other repositories. Find existing containers. Execute a Singularity container.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-nextflow">Introduction to Nextflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-nextflow">What is Nextflow?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-is-nextflow-for">What is Nextflow for?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#main-advantages">Main advantages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#workflow-structure">Workflow structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="second.html">Second Day</a></li>
<li class="toctree-l1"><a class="reference internal" href="third.html">Second Day</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourth.html">First Day</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sphinx Page GitHub Action</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>First Day</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="first-day">
<span id="first-page"></span><h1>First Day<a class="headerlink" href="#first-day" title="Permalink to this headline">¶</a></h1>
<section id="introduction-to-docker-and-singularity-containers">
<h2>Introduction to Docker and Singularity containers.<a class="headerlink" href="#introduction-to-docker-and-singularity-containers" title="Permalink to this headline">¶</a></h2>
<p>TONI</p>
</section>
<section id="docker-hub-biocontainers-and-other-repositories-find-existing-containers-execute-a-singularity-container">
<h2>Docker hub, BioContainers and other repositories. Find existing containers. Execute a Singularity container.<a class="headerlink" href="#docker-hub-biocontainers-and-other-repositories-find-existing-containers-execute-a-singularity-container" title="Permalink to this headline">¶</a></h2>
<p>TONI</p>
</section>
<section id="introduction-to-nextflow">
<h2>Introduction to Nextflow<a class="headerlink" href="#introduction-to-nextflow" title="Permalink to this headline">¶</a></h2>
<p>A DSL for data-driven computational pipelines. <a class="reference external" href="https://www.nextflow.io">www.nextflow.io</a>.</p>
<a class="reference internal image-reference" href="_images/nextflow_logo_deep.png"><img alt="_images/nextflow_logo_deep.png" src="_images/nextflow_logo_deep.png" style="width: 400px;" /></a>
<section id="what-is-nextflow">
<h3>What is Nextflow?<a class="headerlink" href="#what-is-nextflow" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="_images/nextf_groovy.png"><img alt="_images/nextf_groovy.png" src="_images/nextf_groovy.png" style="width: 600px;" /></a>
<p><a class="reference external" href="https://www.nextflow.io">Nextflow</a> is a domain specific language for workflow orchestration that stems from <a class="reference external" href="https://groovy-lang.org/">Groovy</a>. It enables scalable and reproducible workflows using software containers.
It was developed at the <a class="reference external" href="www.crg.eu">CRG</a> in the Lab of Cedric Notredame by <a class="reference external" href="https://github.com/pditommaso">Paolo Di Tommaso</a>.
The Nextflow documentation is <a class="reference external" href="https://www.nextflow.io/docs/latest/">available here</a> and you can ask help to the community using their <a class="reference external" href="https://gitter.im/nextflow-io/nextflow">gitter channel</a></p>
<p>Nextflow has been upgraded in 2020 from DSL1 (Domain-Specific Language) version to DSL2. In this course we will use exclusively DSL2.</p>
</section>
<section id="what-is-nextflow-for">
<h3>What is Nextflow for?<a class="headerlink" href="#what-is-nextflow-for" title="Permalink to this headline">¶</a></h3>
<p>It is for making pipelines without caring about parallelization, dependencies, intermediate file names, data structures, handling exceptions, resuming executions etc.</p>
<p>It was published in <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/28398311/">Nature Biotechnology in 2017</a>.</p>
<a class="reference internal image-reference" href="_images/NF_pub.png"><img alt="_images/NF_pub.png" src="_images/NF_pub.png" style="width: 600px;" /></a>
<p>There is a growing number of publications mentioning Nextflow in <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/?term=nextflow&amp;timeline=expanded&amp;sort=pubdate&amp;sort_order=asc">PubMed</a>, since many bioinformaticians are starting to write their pipeline with Nextflow.</p>
<a class="reference internal image-reference" href="_images/NF_mentioning.png"><img alt="_images/NF_mentioning.png" src="_images/NF_mentioning.png" style="width: 600px;" /></a>
<p>Here is a curated list of <a class="reference external" href="https://github.com/nextflow-io/awesome-nextflow">Nextflow pipelines</a>.</p>
<p>And here is a group of pipelines written in a collaborative way from the <a class="reference external" href="https://nf-co.re/pipelines">NF-core</a> project.</p>
<p>Some pipelines written in Nextflow are used for SARS-Cov-2 analysis, for example:</p>
<ul class="simple">
<li><p>the <a class="reference external" href="https://artic.network/ncov-2019">artic Network</a> pipeline: <a class="reference external" href="https://github.com/connor-lab/ncov2019-artic-nf">ncov2019-artic-nf</a>.</p></li>
<li><p>the <a class="reference external" href="https://covid19beacon.crg.eu/info">CRG / EGA viral Beacon</a> pipeline: <a class="reference external" href="https://github.com/biocorecrg/master_of_pores">Master of Pores</a>.</p></li>
<li><p>the nf-core pipeline: <a class="reference external" href="https://nf-co.re/viralrecon">viralrecon</a>.</p></li>
</ul>
</section>
<section id="main-advantages">
<h3>Main advantages<a class="headerlink" href="#main-advantages" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Fast prototyping</strong></p></li>
</ul>
<p>You can quickly write a small pipeline that can be <strong>expanded incrementally</strong>.
<strong>Each task is independent</strong> and can be easily added to other ones. You can reuse your scripts and tools without rewriting / adapting them.</p>
<ul class="simple">
<li><p><strong>Reproducibility</strong></p></li>
</ul>
<p>Nextflow supports <strong>Docker and Singularity</strong> containers technology. Their use will make the pipelines reproducible in any Unix environment. Nextflow is integrated with <strong>GitHub code sharing platform</strong>, so you can call directly a specific version of pipeline from a repository, download it and use it on the fly.</p>
<ul class="simple">
<li><p><strong>Portability</strong></p></li>
</ul>
<p>Nextflow can be executed on <strong>multiple platforms</strong> without modifiying the code. It supports several schedulers such as <strong>SGE, LSF, SLURM, PBS and HTCondor</strong> and cloud platforms like <strong>Kubernetes, Amazon AWS and Google Cloud</strong>.</p>
<a class="reference internal image-reference" href="_images/executors.png"><img alt="_images/executors.png" src="_images/executors.png" style="width: 600px;" /></a>
<ul class="simple">
<li><p><strong>Scalability</strong></p></li>
</ul>
<p>Nextflow is based on the <strong>dataflow programming model</strong> which simplifies writing complex pipelines.
The tool takes care of <strong>parallelizing the processes</strong> without additional written code.
The resulting applications are inherently parallel and can scale-up or scale-out, transparently, without having to adapt to a specific platform architecture.</p>
<ul class="simple">
<li><p><strong>Resumable, thanks to continuous checkpoints</strong></p></li>
</ul>
<p>All the intermediate results produced during the pipeline execution are automatically tracked.
For each process <strong>a temporary folder is created and is cached (or not) once resuming an execution</strong>.</p>
</section>
</section>
<section id="workflow-structure">
<h2>Workflow structure<a class="headerlink" href="#workflow-structure" title="Permalink to this headline">¶</a></h2>
<p>The workflows can be represented as graphs where the nodes are the <strong>processes</strong> and the edges are the <strong>channels</strong>.
The <strong>processes</strong> are blocks of code that can be executed - such as scripts or programs - while the <strong>channels</strong> are asynchronous queues able to <strong>connect processes among them via input / output</strong>.</p>
<a class="reference internal image-reference" href="_images/wf_example.png"><img alt="_images/wf_example.png" src="_images/wf_example.png" style="width: 600px;" /></a>
<p>Processes are independent from one another and can be run in parallel depending on the number of elements in a channel.
In the previous example, processes <strong>A</strong>, <strong>B</strong> and <strong>C</strong> can be run in parallel and only when they <strong>ALL</strong> end can process <strong>D</strong> be triggered.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Nextflow is already installed on the machines for the training!
You need at least the Java version 8 for Nextflow installation.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can check the version fo java by typing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">java</span> <span class="o">-</span><span class="n">version</span>
</pre></div>
</div>
</div>
<p>Then we can install Nextflow with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">s</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">get</span><span class="o">.</span><span class="n">nextflow</span><span class="o">.</span><span class="n">io</span> <span class="o">|</span> <span class="n">bash</span>
</pre></div>
</div>
<p>This will create the <code class="docutils literal notranslate"><span class="pre">nextflow</span></code> executable that can be moved, for example, to <code class="docutils literal notranslate"><span class="pre">/usr/local/bin</span></code>.</p>
<p>We can test that the installation was successful with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nextflow run hello</span>

<span class="go">N E X T F L O W  ~  version 20.07.1</span>
<span class="go">Pulling nextflow-io/hello ...</span>
<span class="go">downloaded from https://github.com/nextflow-io/hello.git</span>
<span class="go">Launching `nextflow-io/hello` [peaceful_brahmagupta] - revision: 96eb04d6a4 [master]</span>
<span class="go">executor &gt;  local (4)</span>
<span class="go">[d7/d053b5] process &gt; sayHello (4) [100%] 4 of 4 ✔</span>
<span class="go">Ciao world!</span>
<span class="go">Bonjour world!</span>
<span class="go">Hello world!</span>
<span class="go">Hola world!</span>
</pre></div>
</div>
<p>This command downloads and runs the pipeline <code class="docutils literal notranslate"><span class="pre">hello</span></code>.</p>
<p>We can now launch a test pipeline to show what will be using a nextflow pipeline:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nextflow run nextflow-io/rnaseq-nf -with-singularity</span>
</pre></div>
</div>
<p>The command will automatically pull the pipeline and the required test data from the <a class="reference external" href="https://github.com/nextflow-io/rnatoy">github repository</a>
The command <code class="docutils literal notranslate"><span class="pre">-with-singularity</span></code> will trigger automatically the download of the image <code class="docutils literal notranslate"><span class="pre">nextflow/rnatoy:1.3</span></code> from DockerHub and convert it on the fly into a singularity image that will be used for running each step of the pipeline.
Moreover the pipeline can also recognize the kind of queue system used where is launched. In the following examples I launched the same pipeline both on the CRG high performance computing centre (HPC) and on my MacBook:</p>
<p>The result from CRG’s HPC:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nextflow run nextflow-io/rnaseq-nf -with-singularity</span>

<span class="go">N E X T F L O W  ~  version 21.04.3</span>
<span class="go">Pulling nextflow-io/rnaseq-nf ...</span>
<span class="go">downloaded from https://github.com/nextflow-io/rnaseq-nf.git</span>
<span class="go">Launching `nextflow-io/rnaseq-nf` [serene_wing] - revision: 83bdb3199b [master]</span>
<span class="go">R N A S E Q - N F   P I P E L I N E</span>
<span class="go"> ===================================</span>
<span class="go">transcriptome: /users/bi/lcozzuto/.nextflow/assets/nextflow-io/rnaseq-nf/data/ggal/ggal_1_48850000_49020000.Ggal71.500bpflank.fa</span>
<span class="go">reads        : /users/bi/lcozzuto/.nextflow/assets/nextflow-io/rnaseq-nf/data/ggal/*_{1,2}.fq</span>
<span class="go">outdir       : results</span>

<span class="go">[-        ] process &gt; RNASEQ:INDEX  -</span>
<span class="go">[-        ] process &gt; RNASEQ:FASTQC -</span>
<span class="go">executor &gt;  crg (6)</span>
<span class="go">[cc/dd76f0] process &gt; RNASEQ:INDEX (ggal_1_48850000_49020000) [100%] 1 of 1 ✔</span>
<span class="go">[7d/7a96f2] process &gt; RNASEQ:FASTQC (FASTQC on ggal_liver)    [100%] 2 of 2 ✔</span>
<span class="go">[ab/ac8558] process &gt; RNASEQ:QUANT (ggal_gut)                 [100%] 2 of 2 ✔</span>
<span class="go">[a0/452d3f] process &gt; MULTIQC                                 [100%] 1 of 1 ✔</span>

<span class="go">Pulling Singularity image docker://quay.io/nextflow/rnaseq-nf:v1.0 [cache /nfs/users2/bi/lcozzuto/aaa/work/singularity/quay.io-nextflow-rnaseq-nf-v1.0.img]</span>
<span class="go">WARN: Singularity cache directory has not been defined -- Remote image will be stored in the path: /nfs/users2/bi/lcozzuto/aaa/work/singularity -- Use env  variable NXF_SINGULARITY_CACHEDIR to specify a different location</span>
<span class="go">        Done! Open the following report in your browser --&gt; results/multiqc_report.html</span>

<span class="go">Completed at: 01-Oct-2021 12:01:50</span>
<span class="go">Duration    : 3m 57s</span>
<span class="go">CPU hours   : (a few seconds)</span>
<span class="go">Succeeded   : 6</span>
</pre></div>
</div>
<p>The result from my MacBook:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nextflow run nextflow-io/rnaseq-nf -with-docker</span>

<span class="go">N E X T F L O W  ~  version 21.04.3</span>
<span class="go">Launching `nextflow-io/rnaseq-nf` [happy_torvalds] - revision: 83bdb3199b [master]</span>
<span class="go">R N A S E Q - N F   P I P E L I N E</span>
<span class="go">===================================</span>
<span class="go">transcriptome: /Users/lcozzuto/.nextflow/assets/nextflow-io/rnaseq-nf/data/ggal/ggal_1_48850000_49020000.Ggal71.500bpflank.fa</span>
<span class="go">reads        : /Users/lcozzuto/.nextflow/assets/nextflow-io/rnaseq-nf/data/ggal/*_{1,2}.fq</span>
<span class="go">outdir       : results</span>

<span class="go">executor &gt;  local (6)</span>
<span class="go">[37/933971] process &gt; RNASEQ:INDEX (ggal_1_48850000_49020000) [100%] 1 of 1 ✔</span>
<span class="go">[fe/b06693] process &gt; RNASEQ:FASTQC (FASTQC on ggal_gut)      [100%] 2 of 2 ✔</span>
<span class="go">[73/84b898] process &gt; RNASEQ:QUANT (ggal_gut)                 [100%] 2 of 2 ✔</span>
<span class="go">[f2/917905] process &gt; MULTIQC                                 [100%] 1 of 1 ✔</span>

<span class="go">Done! Open the following report in your browser --&gt; results/multiqc_report.html</span>
</pre></div>
</div>
<p>This is just an example of the power of the automation of the Nextflow environment.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="second.html" class="btn btn-neutral float-right" title="Second Day" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="about.html" class="btn btn-neutral float-left" title="About the course" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019, Sean Zheng.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>